<!DOCTYPE html>
<html>
<head>
  <title>Store Data by Store Number</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <style>
    body { font-family: Arial; margin: 40px; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 40px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #007BFF; color: white; }
    tr:nth-child(even) { background-color: #f2f2f2; }
    .store-section { margin-top: 40px; }
  </style>
</head>
<body>

<h2>Store Data by Store Number</h2>
<div id="storeTables"></div>

<script>
  // --- Firebase Config ---
  const firebaseConfig = {
    apiKey: "AIzaSyAkSlyFKQNHYQgLa_dQuzYSzXSISoCWKU",
    authDomain: "college-football-pickem-68eed.firebaseapp.com",
    projectId: "college-football-pickem-68eed",
    storageBucket: "college-football-pickem-68eed.appspot.com",
    messagingSenderId: "650202039805",
    appId: "1:650202039805:web:70e51177aab22e4d614594"
  };

  if (!firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
  }

  const db = firebase.firestore();
  const storeTables = document.getElementById("storeTables");

  storeTables.innerHTML = "<p>Loading data...</p>";

  // --- Fetch all data ---
  db.collection("storeData").get()
    .then(snapshot => {
      if (snapshot.empty) {
        storeTables.innerHTML = "<p>No data found.</p>";
        return;
      }

      const grouped = {};

      snapshot.forEach(doc => {
        const d = doc.data();
        const store = d.storeNum || "Unknown";
        if (!grouped[store]) grouped[store] = [];
        grouped[store].push(d);
      });

      storeTables.innerHTML = "";

      // --- Build tables per store ---
      Object.keys(grouped).sort((a,b)=>a-b).forEach(store => {
        const entries = grouped[store];
        const section = document.createElement("div");
        section.className = "store-section";
        section.innerHTML = `
          <h3>Store #${store}</h3>
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Sales Daily ($)</th>
                <th>Sales Weekly ($)</th>
                <th>Payroll (%)</th>
                <th>Food Cost (%)</th>
                <th>Violation (%)</th>
                <th>Extra Payroll (%)</th>
                <th>Training (%)</th>
              </tr>
            </thead>
            <tbody>
              ${entries.map(d => `
                <tr>
                  <td>${d.date || "-"}</td>
                  <td>${d.salesDay || "-"}</td>
                  <td>${d.salesWeek || "-"}</td>
                  <td>${d.payroll || "-"}</td>
                  <td>${d.foodCost || "-"}</td>
                  <td>${d.violation || "-"}</td>
                  <td>${d.extPayroll || "-"}</td>
                  <td>${d.training || "-"}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        `;
        storeTables.appendChild(section);
      });

    })
    .catch(err => {
      console.error("Error reading data:", err);
      storeTables.innerHTML = "<p>Error loading data. Check console.</p>";
    });
</script>

</body>
</html>
