<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content ="width=device-width, initial-scale=1">
      <!--<link rel="stylesheet" href="mystyle.css">-->
    <title>My bets</title>
    <link rel="stylesheet" href="mybets.css">
  </head>
  <body>
    <h1>My Bets</h1>
    <h3>Week 7</h3>
    <table id="live_bets_table">
        <tr>
            <th>Bet</th>
            <th>Live Score</th>
        </tr>
    </table>
    <p>
    </p>

    <script>

function Get(yourUrl){
            var Httpreq = new XMLHttpRequest();
            Httpreq.open("GET",yourUrl,false);
            Httpreq.send(null);
            return Httpreq.responseText;
        }

        async function launch(params) {
            const res = await fetch("https://script.google.com/macros/s/AKfycbySoSRkl2kieckMhbwkdM9gN_yuCpoJqI9dw-F4cjuB45PC3vVYfzbUMcx92kKBN2o/exec");
            let espnUrl = "https://site.api.espn.com/apis/site/v2/sports/football/college-football/scoreboard?dates=20241012";
            var scoreboard = JSON.parse(Get(espnUrl));
            console.log(scoreboard)

            const { data } = await res.json();
            for(let i =0; i<scoreboard.events.length; i++){
                for(let j =0; j<data.length ; j++){
                    if(data[j].homeTeam == scoreboard.events[i]['competitions'][0]['competitors'][0]['team']['location']){
                        console.log(data[j].homeTeam)
                        console.log(scoreboard.events[i]['competitions'][0]['competitors'][0]['team']['location'])
                        var myBets = document.getElementById("live_bets_table")
                        var newRow = myBets.insertRow();
                        var cell1 = newRow.insertCell(0);
                        var cell2 = newRow.insertCell(1);
                        
                        game_id = i
                        let team1 = scoreboard['events'][game_id]['competitions'][0]['competitors'][1]['team']['abbreviation'];
                        let team1Score = scoreboard['events'][game_id]['competitions'][0]['competitors'][1]['score'];
                        let team2 = scoreboard['events'][game_id]['competitions'][0]['competitors'][0]['team']['abbreviation'];
                        let team2Score = scoreboard['events'][game_id]['competitions'][0]['competitors'][0]['score'];
                        let timeReamining = scoreboard.events[game_id].status.type.detail
                        score = `${team1} ${team1Score} @ ${team2} ${team2Score}   ${timeReamining}<br><br>`;

                        cell1.innerHTML = data[j].bet
                        cell2.innerHTML = score;


            }
        }

        }
    }
        launch();
    </script>
  </body>
</html>